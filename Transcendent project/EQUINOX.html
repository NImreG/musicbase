<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EQUINOX</title>
    <link rel="stylesheet" href="EQUINOX.css">
</head>
<body>

    <div class="outercon">

        <!-- Rotating halves + balls -->
        <div class="innercon top">
            <div class="half brightness"></div>
            <div class="half darkness"></div>
            <div class="ball top"></div>
            <div class="ball bottom"></div>
        </div>

        <div class="innercon bottom">
            <div class="half brightness"></div>
            <div class="half darkness"></div>
            <div class="ball top"></div>
            <div class="ball bottom"></div>
        </div>

        <!-- Clickable EQUINOX canvas -->
        <div class="canvas-container disabled-text" id="canvasContainer">
            <canvas id="mainCanvas" width="800" height="120"></canvas>
        </div>

        <!-- Hidden Audio -->
        <div class="tempaudio" id="audioContainer">
            <audio id="equinoxAudio" loop>
                <source src="EQUINOX_Sol's_RNG.mp3" type="audio/mpeg">
            </audio>
        </div>

    </div>

    <script>
        const canvas = document.getElementById('mainCanvas');
        const ctx = canvas.getContext('2d');
        const canvasContainer = document.getElementById('canvasContainer');
        const innerCons = document.querySelectorAll('.innercon');
        const topBalls = document.querySelectorAll('.ball.top');
        const bottomBalls = document.querySelectorAll('.ball.bottom');
        const brightnessEls = document.querySelectorAll('.brightness');
        const darknessEls = document.querySelectorAll('.darkness');
        const audioElement = document.getElementById('equinoxAudio');

        const text = "EQUINOX";
        const fontSize = 100;
        const fontFamily = "Audiowide, sans-serif";

        let animationsEnabled = false;
        let swapInterval = null;
        let halfSwapWhite = true;
        let textSwapWhite = false;
        let lastTextSwap = performance.now();

        // Draw grey disabled text initially
        function drawDisabledText() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.font = `${fontSize}px ${fontFamily}`;
            ctx.textAlign = "center";
            ctx.textBaseline = "middle";
            ctx.fillStyle = "grey";
            ctx.shadowColor = "rgba(0,0,0,0.3)";
            ctx.shadowBlur = 5;
            ctx.fillText(text, canvas.width / 2, canvas.height / 1.8);
        }
        drawDisabledText();

        // Animated top/bottom text
        function draw(timestamp = performance.now()) {
            if (!animationsEnabled) return;

            ctx.clearRect(0, 0, canvas.width, canvas.height);
            const x = canvas.width / 2;
            const y = canvas.height / 1.8;

            if (timestamp - lastTextSwap > 250) {
                lastTextSwap = timestamp;
                textSwapWhite = !textSwapWhite;
            }

            ctx.save();
            ctx.beginPath();
            ctx.rect(0, 0, canvas.width, canvas.height / 2);
            ctx.clip();
            ctx.font = `${fontSize}px ${fontFamily}`;
            ctx.textAlign = "center";
            ctx.textBaseline = "middle";
            ctx.fillStyle = textSwapWhite ? "white" : "black";
            ctx.shadowColor = textSwapWhite ? "black" : "white";
            ctx.shadowBlur = 10;
            ctx.fillText(text, x, y);
            ctx.restore();

            ctx.save();
            ctx.beginPath();
            ctx.rect(0, canvas.height / 2, canvas.width, canvas.height / 2);
            ctx.clip();
            ctx.font = `${fontSize}px ${fontFamily}`;
            ctx.textAlign = "center";
            ctx.textBaseline = "middle";
            ctx.fillStyle = textSwapWhite ? "black" : "white";
            ctx.shadowColor = textSwapWhite ? "white" : "black";
            ctx.shadowBlur = 10;
            ctx.fillText(text, x, y);
            ctx.restore();

            requestAnimationFrame(draw);
        }

        // Half+ball color swap
        function applyHalfColors() {
            const bright = halfSwapWhite ? "white" : "black";
            const dark = halfSwapWhite ? "black" : "white";

            brightnessEls.forEach(el => el.style.backgroundColor = bright);
            darknessEls.forEach(el => el.style.backgroundColor = dark);

            topBalls.forEach(b => {
                b.style.backgroundColor = bright;
                b.style.boxShadow = bright === "white" ? "0 0 60px rgba(255,255,255,0.85)" : "0 0 60px rgba(0,0,0,0.85)";
                b.style.opacity = '1';
            });
            bottomBalls.forEach(b => {
                b.style.backgroundColor = dark;
                b.style.boxShadow = dark === "white" ? "0 0 60px rgba(255,255,255,0.85)" : "0 0 60px rgba(0,0,0,0.85)";
                b.style.opacity = '1';
            });
        }

        function swapHalves() {
            brightnessEls.forEach(el => el.style.filter = 'blur(4px)');
            darknessEls.forEach(el => el.style.filter = 'blur(4px)');

            halfSwapWhite = !halfSwapWhite;
            applyHalfColors();

            setTimeout(() => {
                brightnessEls.forEach(el => el.style.filter = 'blur(0px)');
                darknessEls.forEach(el => el.style.filter = 'blur(0px)');
            }, 100);
        }

        // Reset everything visually but keep audio time
        function resetVisuals() {
            animationsEnabled = false;
            canvasContainer.classList.remove('tilt');
            canvasContainer.classList.add('disabled-text');
            innerCons.forEach(c => { c.style.opacity = '0'; c.style.animationPlayState = 'paused'; });
            clearInterval(swapInterval);
            swapInterval = null;
            drawDisabledText();
        }

        // Toggle everything
        canvasContainer.addEventListener('click', () => {
            if (!animationsEnabled) {
                // Enable everything
                animationsEnabled = true;
                canvasContainer.classList.add('tilt');
                canvasContainer.classList.remove('disabled-text');
                innerCons.forEach(c => { c.style.opacity = '1'; c.style.animationPlayState = 'running'; });
                applyHalfColors();
                swapInterval = setInterval(swapHalves, 1250);
                audioElement.play();
                requestAnimationFrame(draw);
            } else {
                // Disable animations but **keep music progress**
                resetVisuals();
                audioElement.pause();
            }
        });
    </script>

</body>

</html>